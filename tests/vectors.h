#ifndef FPE_TEST_VECTORS_H
#define FPE_TEST_VECTORS_H

#include "fpe.h" // 假设 fpe.h 定义了 FPE_MODE 枚举

typedef struct {
    const char *alg_name;       // "AES-128", "AES-192", "AES-256", "SM4"
    FPE_MODE mode;              // FPE_MODE_FF1, FPE_MODE_FF3, FPE_MODE_FF3_1
    unsigned int radix;
    const char *key_hex;
    const char *tweak_hex;      // Hex string, use "" for empty
    const char *plaintext;      // ASCII string of digits/chars
    const char *ciphertext;     // Expected result
} fpe_test_vector_t;

static const fpe_test_vector_t test_vectors[] = {

    /* ====================================================================
     * FF1 Vectors (Source: NIST SP 800-38G / test.py)
     * ==================================================================== */

    // --- AES-128 ---
    { "AES-128", FPE_MODE_FF1, 10, "2B7E151628AED2A6ABF7158809CF4F3C", "", "0123456789", "2433477484" },
    { "AES-128", FPE_MODE_FF1, 10, "2B7E151628AED2A6ABF7158809CF4F3C", "39383736353433323130", "0123456789", "6124200773" },
    { "AES-128", FPE_MODE_FF1, 36, "2B7E151628AED2A6ABF7158809CF4F3C", "3737373770717273373737", "0123456789abcdefghi", "a9tv40mll9kdu509eum" },

    // --- AES-192 ---
    { "AES-192", FPE_MODE_FF1, 10, "2B7E151628AED2A6ABF7158809CF4F3CEF4359D8D580AA4F", "", "0123456789", "2830668132" },
    { "AES-192", FPE_MODE_FF1, 10, "2B7E151628AED2A6ABF7158809CF4F3CEF4359D8D580AA4F", "39383736353433323130", "0123456789", "2496655549" },
    { "AES-192", FPE_MODE_FF1, 36, "2B7E151628AED2A6ABF7158809CF4F3CEF4359D8D580AA4F", "3737373770717273373737", "0123456789abcdefghi", "xbj3kv35jrawxv32ysr" },

    // --- AES-256 ---
    { "AES-256", FPE_MODE_FF1, 10, "2B7E151628AED2A6ABF7158809CF4F3CEF4359D8D580AA4F7F036D6F04FC6A94", "", "0123456789", "6657667009" },
    { "AES-256", FPE_MODE_FF1, 10, "2B7E151628AED2A6ABF7158809CF4F3CEF4359D8D580AA4F7F036D6F04FC6A94", "39383736353433323130", "0123456789", "1001623463" },
    { "AES-256", FPE_MODE_FF1, 36, "2B7E151628AED2A6ABF7158809CF4F3CEF4359D8D580AA4F7F036D6F04FC6A94", "3737373770717273373737", "0123456789abcdefghi", "xs8a0azh2avyalyzuwd" },

    /* ====================================================================
     * FF3 Vectors
     * Note: FF3 requires Key Reversal in implementation (or pre-reversed here).
     * We assume that library handles reversal internally based on Spec.
     * ==================================================================== */

    // --- AES-128 ---
    { "AES-128", FPE_MODE_FF3, 10, "EF4359D8D580AA4F7F036D6F04FC6A94", "D8E7920AFA330A73", "890121234567890000", "750918814058654607" },
    { "AES-128", FPE_MODE_FF3, 10, "EF4359D8D580AA4F7F036D6F04FC6A94", "9A768A92F60E12D8", "890121234567890000", "018989839189395384" },
    { "AES-128", FPE_MODE_FF3, 10, "EF4359D8D580AA4F7F036D6F04FC6A94", "D8E7920AFA330A73", "89012123456789000000789000000", "48598367162252569629397416226" },
    { "AES-128", FPE_MODE_FF3, 10, "EF4359D8D580AA4F7F036D6F04FC6A94", "0000000000000000", "89012123456789000000789000000", "34695224821734535122613701434" },
    { "AES-128", FPE_MODE_FF3, 26, "EF4359D8D580AA4F7F036D6F04FC6A94", "9A768A92F60E12D8", "0123456789abcdefghi", "g2pk40i992fn20cjakb" },

    // --- AES-192 ---
    { "AES-192", FPE_MODE_FF3, 10, "EF4359D8D580AA4F7F036D6F04FC6A942B7E151628AED2A6", "D8E7920AFA330A73", "890121234567890000", "646965393875028755" },
    { "AES-192", FPE_MODE_FF3, 10, "EF4359D8D580AA4F7F036D6F04FC6A942B7E151628AED2A6", "9A768A92F60E12D8", "890121234567890000", "961610514491424446" },
    { "AES-192", FPE_MODE_FF3, 10, "EF4359D8D580AA4F7F036D6F04FC6A942B7E151628AED2A6", "D8E7920AFA330A73", "89012123456789000000789000000", "53048884065350204541786380807" },
    { "AES-192", FPE_MODE_FF3, 10, "EF4359D8D580AA4F7F036D6F04FC6A942B7E151628AED2A6", "0000000000000000", "89012123456789000000789000000", "98083802678820389295041483512" },
    { "AES-192", FPE_MODE_FF3, 26, "EF4359D8D580AA4F7F036D6F04FC6A942B7E151628AED2A6", "9A768A92F60E12D8", "0123456789abcdefghi", "i0ihe2jfj7a9opf9p88" },

    // --- AES-256 ---
    { "AES-256", FPE_MODE_FF3, 10, "EF4359D8D580AA4F7F036D6F04FC6A942B7E151628AED2A6ABF7158809CF4F3C", "D8E7920AFA330A73", "890121234567890000", "922011205562777495" },
    { "AES-256", FPE_MODE_FF3, 10, "EF4359D8D580AA4F7F036D6F04FC6A942B7E151628AED2A6ABF7158809CF4F3C", "9A768A92F60E12D8", "890121234567890000", "504149865578056140" },
    { "AES-256", FPE_MODE_FF3, 10, "EF4359D8D580AA4F7F036D6F04FC6A942B7E151628AED2A6ABF7158809CF4F3C", "D8E7920AFA330A73", "89012123456789000000789000000", "04344343235792599165734622699" },
    { "AES-256", FPE_MODE_FF3, 10, "EF4359D8D580AA4F7F036D6F04FC6A942B7E151628AED2A6ABF7158809CF4F3C", "0000000000000000", "89012123456789000000789000000", "308592399993740538723655822" },
    { "AES-256", FPE_MODE_FF3, 26, "EF4359D8D580AA4F7F036D6F04FC6A942B7E151628AED2A6ABF7158809CF4F3C", "9A768A92F60E12D8", "0123456789abcdefghi", "p0b2godfja9bhb7bk38" },

    /* ====================================================================
     * FF3-1 Vectors
     * ==================================================================== */

    // --- AES-128 ---
    { "AES-128", FPE_MODE_FF3_1, 10, "EF4359D8D580AA4F7F036D6F04FC6A94", "D8E7920AFA330A", "890121234567890000", "814997673314616621" },
    { "AES-128", FPE_MODE_FF3_1, 10, "EF4359D8D580AA4F7F036D6F04FC6A94", "9A768A92F60E12", "890121234567890000", "733896897510917587" },
    { "AES-128", FPE_MODE_FF3_1, 10, "EF4359D8D580AA4F7F036D6F04FC6A94", "D8E7920AFA330A", "89012123456789000000789000000", "74700942206520203572429371837" },
    { "AES-128", FPE_MODE_FF3_1, 10, "EF4359D8D580AA4F7F036D6F04FC6A94", "00000000000000", "89012123456789000000789000000", "34695224821734535122613701434" },
    { "AES-128", FPE_MODE_FF3_1, 26, "EF4359D8D580AA4F7F036D6F04FC6A94", "9A768A92F60E12D8", "0123456789abcdefghi", "ao0d2gc1ca3i0121p58" },

    // --- AES-192 ---
    { "AES-192", FPE_MODE_FF3_1, 10, "EF4359D8D580AA4F7F036D6F04FC6A942B7E151628AED2A6", "D8E7920AFA330A", "890121234567890000", "088425252487872053" },
    { "AES-192", FPE_MODE_FF3_1, 10, "EF4359D8D580AA4F7F036D6F04FC6A942B7E151628AED2A6", "9A768A92F60E12D8", "890121234567890000", "926248174806830704" },
    { "AES-192", FPE_MODE_FF3_1, 10, "EF4359D8D580AA4F7F036D6F04FC6A942B7E151628AED2A6", "D8E7920AFA330A", "89012123456789000000789000000", "18912741172273447257239338396" },
    { "AES-192", FPE_MODE_FF3_1, 10, "EF4359D8D580AA4F7F036D6F04FC6A942B7E151628AED2A6", "00000000000000", "89012123456789000000789000000", "98083802678820389295041483512" },
    { "AES-192", FPE_MODE_FF3_1, 26, "EF4359D8D580AA4F7F036D6F04FC6A942B7E151628AED2A6", "9A768A92F60E12D8", "0123456789abcdefghi", "bf7872m846567h6b4pm" },

    // --- AES-256 ---
    { "AES-256", FPE_MODE_FF3_1, 10, "EF4359D8D580AA4F7F036D6F04FC6A942B7E151628AED2A6ABF7158809CF4F3C", "D8E7920AFA330A", "890121234567890000", "375943975111567310" },
    { "AES-256", FPE_MODE_FF3_1, 10, "EF4359D8D580AA4F7F036D6F04FC6A942B7E151628AED2A6ABF7158809CF4F3C", "9A768A92F60E12D8", "890121234567890000", "529559996580804303" },
    { "AES-256", FPE_MODE_FF3_1, 10, "EF4359D8D580AA4F7F036D6F04FC6A942B7E151628AED2A6ABF7158809CF4F3C", "D8E7920AFA330A", "89012123456789000000789000000", "54988118574366877104446093026" },
    { "AES-256", FPE_MODE_FF3_1, 10, "EF4359D8D580AA4F7F036D6F04FC6A942B7E151628AED2A6ABF7158809CF4F3C", "00000000000000", "89012123456789000000789000000", "308592399993740538723655822" },
    { "AES-256", FPE_MODE_FF3_1, 26, "EF4359D8D580AA4F7F036D6F04FC6A942B7E151628AED2A6ABF7158809CF4F3C", "9A768A92F60E12D8", "0123456789abcdefghi", "keo739ag6ola81n640k" },

    /* ====================================================================
     * SM4 Vectors
     * SM4 is a Chinese national standard cipher (GB/T 32907-2016)
     * Test vectors are provided for FF1, FF3, FF3-1 with SM4-128
     * ==================================================================== */

    // --- FF1 with SM4-128 ---
    { "SM4-128", FPE_MODE_FF1, 10, "0123456789ABCDEFFEDCBA9876543210", "39383736353433323130", "1234567890", "3805849473" },
    { "SM4-128", FPE_MODE_FF1, 10, "0123456789ABCDEFFEDCBA9876543210", "3938373635343332", "1234567890", "0244363969" },
    // NOTE: Removed problematic vector with odd-length tweak hex "393837363534333"
    { "SM4-128", FPE_MODE_FF1, 36, "0123456789ABCDEFFEDCBA9876543210", "", "0123456789abcdefghi", "vsxvfxa16cjf2utxvlg" },

    // --- FF3 with SM4-128 ---
    { "SM4-128", FPE_MODE_FF3, 10, "0123456789ABCDEFFEDCBA9876543210", "3938373635343332", "1234567890", "4006222465" },
    { "SM4-128", FPE_MODE_FF3, 10, "0123456789ABCDEFFEDCBA9876543210", "", "01234567890", "8230614527" },

    // --- FF3-1 with SM4-128 ---
    { "SM4-128", FPE_MODE_FF3_1, 10, "0123456789ABCDEFFEDCBA9876543210", "3938373635343332", "1234567890", "0574989661" },

    { NULL, 0, 0, NULL, NULL, NULL, NULL } // Sentinel
};

#endif // FPE_TEST_VECTORS_H
